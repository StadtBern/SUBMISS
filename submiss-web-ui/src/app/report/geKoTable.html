<!--
  ~  Submiss, eProcurement system for managing tenders
  ~  Copyright (C) 2019 Stadt Bern
  ~  Licensed under the EUPL, Version 1.2 or - as soon as they will be approved by the European Commission - subsequent versions of the EUPL (the "Licence");
  ~  You may not use this work except in compliance with the Licence.
  ~  You may obtain a copy of the Licence at:
  ~  https://joinup.ec.europa.eu/collection/eupl
  ~  Unless required by applicable law or agreed to in writing, software distributed under the Licence is
  ~  distributed on an "AS IS" basis, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
  ~  express or implied. See the Licence for the specific language governing permissions and limitations
  ~  under the Licence.
  -->

<div class="modal-body">
  <div class="row">
    <div class="col-sm-12 insertedCriteria">
      <p>
        <strong>Selektiert nach:</strong>
        <ul class="list-inline">
          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.startDate, geKoTableCtr.reportForm.endDate)">
            <strong>Zeitraum: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.startDate, geKoTableCtr.reportForm.endDate)}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.directorates)">
            <strong>Direktion: </strong> {{geKoTableCtr.reportResults.searchedCriteria.Direktion}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.departments)">
            <strong>Abteilung: </strong> {{geKoTableCtr.reportResults.searchedCriteria.Abteilung}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.objects)">
            <strong>Objekt: </strong> {{geKoTableCtr.reportResults.searchedCriteria.Objekt}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.projects)">
            <strong>Projektname: </strong> {{geKoTableCtr.reportResults.searchedCriteria.ProjektName}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.workTypes)">
            <strong>Arbeitsgattung: </strong> {{geKoTableCtr.reportResults.searchedCriteria.Arbeitsgattung}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.procedures)">
            <strong>Verfahren: </strong> {{geKoTableCtr.reportResults.searchedCriteria.Verfahren}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.description)">
            <strong>Beschreibung: </strong> {{geKoTableCtr.reportResults.searchedCriteria.Beschreibung}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.gattWto)">
            <strong>GATT/WTO: </strong> {{geKoTableCtr.reportForm.gattWto ? 'Ja' : 'Nein'}}
          </li>
          <!-- Dates -->
          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.publicationDateAwardFrom, geKoTableCtr.reportForm.publicationDateAwardTo)">
            <strong>Publikation Zuschlag: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.publicationDateAwardFrom, geKoTableCtr.reportForm.publicationDateAwardTo)}}
          </li>

          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.publicationDateDirectAwardFrom, geKoTableCtr.reportForm.publicationDateDirectAwardTo)">
            <strong>Publikation Absicht freihändige Vergabe: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.publicationDateDirectAwardFrom, geKoTableCtr.reportForm.publicationDateDirectAwardTo)}}
          </li>

          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.publicationDateFrom, geKoTableCtr.reportForm.publicationDateTo)">
            <strong>Publikation: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.publicationDateFrom, geKoTableCtr.reportForm.publicationDateTo)}}
          </li>

          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.firstDeadlineFrom, geKoTableCtr.reportForm.firstDeadlineTo)">
            <strong>Eingabetermin 1: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.firstDeadlineFrom, geKoTableCtr.reportForm.firstDeadlineTo)}}
          </li>

          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.applicationOpeningDateFrom, geKoTableCtr.reportForm.applicationOpeningDateTo)">
            <strong>Bewerbungsöffnung: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.applicationOpeningDateFrom, geKoTableCtr.reportForm.applicationOpeningDateTo)}}
          </li>

          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.secondDeadlineFrom, geKoTableCtr.reportForm.secondDeadlineTo)">
            <strong>Eingabetermin 2: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.secondDeadlineFrom, geKoTableCtr.reportForm.secondDeadlineTo)}}
          </li>

          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.offerOpeningDateFrom, geKoTableCtr.reportForm.offerOpeningDateTo)">
            <strong>Offertöffnung: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.offerOpeningDateFrom, geKoTableCtr.reportForm.offerOpeningDateTo)}}
          </li>

          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.firstLevelavailableDateFrom, geKoTableCtr.reportForm.firstLevelavailableDateTo)">
            <strong>Verfügungsdatum 1.Stufe: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.firstLevelavailableDateFrom, geKoTableCtr.reportForm.firstLevelavailableDateTo)}}
          </li>

          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.commissionProcurementProposalDateFrom, geKoTableCtr.commissionProcurementProposalDateTo)">
            <strong>BeKo-Sitzung: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.commissionProcurementProposalDateFrom, geKoTableCtr.reportForm.commissionProcurementProposalDateTo)}}
          </li>

          <li
            ng-if="geKoTableCtr.isDateCriteriaAsked(geKoTableCtr.reportForm.levelavailableDateFrom, geKoTableCtr.reportForm.levelavailableDateTo)">
            <strong>Verfügungsdatum: </strong>
            {{geKoTableCtr.getDateInterval(geKoTableCtr.reportForm.levelavailableDateFrom, geKoTableCtr.reportForm.levelavailableDateTo)}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.awardCompany)">
            <strong>Zuschlagsempfänger: </strong> {{geKoTableCtr.reportForm.awardCompany}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.intern)">
            <strong>Intern/Extern: </strong> {{geKoTableCtr.reportForm.intern ? 'Intern' : 'Extern'}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.notes)">
            <strong>Submissionsbemerkungen: </strong>
            {{geKoTableCtr.reportResults.searchedCriteria.Submissionsbemerkungen}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.cancelationreasons)">
            <strong>Verfahrensabbruch: </strong> {{geKoTableCtr.reportResults.searchedCriteria.Verfahrensabbruch}}
          </li>

          <li ng-if="geKoTableCtr.isNotUndefinedOrNull(geKoTableCtr.reportForm.reasonFreeAwards)">
            <strong>Freihandvergabe: </strong> {{geKoTableCtr.reportResults.searchedCriteria.Freihandvergabe}}
          </li>
        </ul>
      </p>
      <p>
        <strong>Gesamttotal: {{geKoTableCtr.reportResults.total}}</strong>
      </p>
      <p>
        <spam ng-if="geKoTableCtr.isColumnSelected('S/O-Aufträge exkl.MWST')">
          <strong>S/O-Aufträge exkl.MWST: </strong> {{geKoTableCtr.reportResults.soSum}}
        </spam>
        <spam ng-if="geKoTableCtr.isColumnSelected('E-Aufträge exkl.MWST')">
          <strong>&nbsp;E-Aufträge exkl.MWST: </strong> {{geKoTableCtr.reportResults.eSum}}
        </spam>
        <spam ng-if="geKoTableCtr.isColumnSelected('F-Aufträge exkl.MWST')">
          <strong>&nbsp;F-Aufträge exkl.MWST: </strong> {{geKoTableCtr.reportResults.fSum}}
        </spam>
      </p>
    </div>

    <div class="col-sm-12 ToolbarContainer" id="results">
      <div class="btn-toolbar  pull-right">
        <multiselect-dropdown id='test' model="geKoTableCtr.selectedColumns" options="geKoTableCtr.availableColumns">
        </multiselect-dropdown>

        <div class="btn-group pull-right" uib-dropdown>
          <button id="" type="button" class="btn btn-primary" uib-dropdown-toggle>
            <em class="fa fa-download" aria-hidden="true"></em> Export <em class="fa fa-caret-down"
              aria-hidden="true"></em>
          </button>
          <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="Export">
            <li role="menuitem"><a ng-click="geKoTableCtr.exportReport('.pdf')"> <em class="fa fa-file-pdf-o"
                  aria-hidden="true"></em> PDF-Format
              </a></li>
            <li role="menuitem"><a ng-click="geKoTableCtr.exportReport('.xlsx')"> <em class="fa fa-file-excel-o"
                  aria-hidden="true"></em> Excel-Format
              </a></li>
            <li role="menuitem"><a ng-click="geKoTableCtr.exportReport('.xlsx2')"> <em class="fa fa-file-excel-o"
                  aria-hidden="true"></em> Neu Excel-Format
              </a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="col-sm-12">
      <div ng-table-pagination="geKoTableCtr.tableParams" template-url="'app/layout/pager.html'"></div>
      <div class="table-responsive">
        <table ng-table="geKoTableCtr.tableParams" class="table table-striped mailSendAction" show-filter="true">
          <tr ng-repeat="gekoResults in $data">
            <!-- mandatory shown columns -->
            <td title="'Direktion'" sortable="'directorate'">{{gekoResults.project.department.directorate.name}}</td>
            <td title="'Abteilung'" sortable="'department'">{{gekoResults.project.department.name}}</td>
            <td title="'Objekt'" sortable="'objectName'">{{gekoResults.project.objectName.value1}}
              {{gekoResults.project.objectName.value2}}</td>
            <td title="'Projektname'" sortable="'projectName'">{{gekoResults.project.projectName}}</td>
            <td title="'Arbeitsgattung'" sortable="'workType'">{{gekoResults.workType.value1}}
              {{gekoResults.workType.value2}}</td>
            <td title="'Beschreibung zur Arbeitsgattung'" sortable="'description'">{{gekoResults.description}}</td>
            <td title="'Verfahren'" sortable="'process'">{{gekoResults.process | translate}}</td>
            <!-- optional shown columns -->
            <td title="'GATT/WTO'" sortable="'gattTwo'" ng-if="geKoTableCtr.isColumnSelected('GATT/WTO')">
              {{gekoResults.gattTwo ? 'Ja' : 'Nein'}}</td>
            <td title="'Publikation Zuschlag'" sortable="'publicationDateAward'"
              ng-if="geKoTableCtr.isColumnSelected('Publikation Zuschlag')">
              {{gekoResults.publicationDateAward  | date:'dd.MM.yyyy'}}</td>
            <td title="'Publikation Absicht freihändige Vergabe'" sortable="'publicationDateDirectAward'"
              ng-if="geKoTableCtr.isColumnSelected('Publikation Absicht freihändige Vergabe')">
              {{gekoResults.publicationDateDirectAward  | date:'dd.MM.yyyy'}}</td>
            <td title="'Publikation'" sortable="'publicationDate'" ng-if="geKoTableCtr.isColumnSelected('Publikation')">
              {{gekoResults.publicationDate  | date:'dd.MM.yyyy'}}</td>
            <td title="'Eingabetermin 1'" sortable="'firstDeadline'"
              ng-if="geKoTableCtr.isColumnSelected('Eingabetermin 1')">
              {{gekoResults.firstDeadline  | date:'dd.MM.yyyy'}}</td>
            <td title="'Bewerbungsöffnung'" sortable="'applicationOpeningDate'"
              ng-if="geKoTableCtr.isColumnSelected('Bewerbungsöffnung')">
              {{gekoResults.applicationOpeningDate  | date:'dd.MM.yyyy'}}</td>
            <td title="'Eingabetermin 2'" sortable="'secondDeadline'"
              ng-if="geKoTableCtr.isColumnSelected('Eingabetermin 2')">
              {{gekoResults.secondDeadline | date:'dd.MM.yyyy'}}</td>
            <td title="'Offertöffnung'" sortable="'offerOpeningDate'"
              ng-if="geKoTableCtr.isColumnSelected('Offertöffnung')">
              {{gekoResults.offerOpeningDate | date:'dd.MM.yyyy'}}</td>
            <td title="'Verfügungsdatum 1.Stufe'" sortable="'firstLevelavailableDate'"
              ng-if="geKoTableCtr.isColumnSelected('Verfügungsdatum 1.Stufe')">
              {{gekoResults.firstLevelavailableDate | date:'dd.MM.yyyy'}}</td>
            <td title="'BeKo-Sitzung'" sortable="'commissionProcurementProposalDate'"
              ng-if="geKoTableCtr.isColumnSelected('BeKo-Sitzung')">
              {{gekoResults.commissionProcurementProposalDate | date:'dd.MM.yyyy'}}</td>
            <td title="'Verfügungsdatum'" sortable="'levelavailableDate'"
              ng-if="geKoTableCtr.isColumnSelected('Verfügungsdatum')">
              {{gekoResults.levelavailableDate | date:'dd.MM.yyyy'}}</td>
            <td title="'Zuschlagsempfänger'" sortable="'submittentName'"
              ng-if="geKoTableCtr.isColumnSelected('Zuschlagsempfänger')">{{gekoResults.submittentName}}</td>
            <td data-title="'S/O-Aufträge exkl.MWST'" ng-if="geKoTableCtr.isColumnSelected('S/O-Aufträge exkl.MWST')">
              {{gekoResults.soSum}}</td>
            <td title="'E-Aufträge exkl.MWST'" ng-if="geKoTableCtr.isColumnSelected('E-Aufträge exkl.MWST')">
              {{gekoResults.eSum}}</td>
            <td title="'F-Aufträge exkl.MWST'" ng-if="geKoTableCtr.isColumnSelected('F-Aufträge exkl.MWST')">
              {{gekoResults.fSum}}</td>
            <td title="'Intern/Extern'" sortable="'project.department.internal'"
              ng-if="geKoTableCtr.isColumnSelected('Intern/Extern')">
              {{gekoResults.project.department.internal ? 'Intern' : 'Extern'}}</td>
            <td title="'Bemerkungsfeld'" sortable="'commentField'"
              ng-if="geKoTableCtr.isColumnSelected('Bemerkungsfeld')" style="min-width:40em;">
              {{gekoResults.commentField}}</td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>
<div class="modal-footer">
  <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="$close()">Abbrechen</button>
</div>

<script type="text/ng-template" id="custom/pager2">
  <div class="PaginationContainer">
    <div class="PaginationLeft">
      <label for="UniqueID004" class="sr-only">
        Ergebnisse pro Seite:
      </label>
      <select id="UniqueID004" ng-change="params.count(params.settings.counts[$index])" ng-param-directive ng-model="params.settings.counts[$index]">
        <option value="10" ng-selected="true">10</option>
        <option value="50">50</option>
        <option value="1000">Alle</option>
      </select>
      <span class="PaginationText">von {{params.total()}} Ergebnissen pro Seite </span>
    </div>
    <div class="PaginationRight">
      <ul class="pagination ng-table-pagination pull-right">
        <li ng-class="{'disabled': !page.active}" ng-repeat="page in pages" ng-switch="page.type"><a ng-switch-when="first" ng-click="params.page(1)" href=""><span class="fa fa-fast-backward"></i></a></li>
        <li ng-class="{'disabled': !page.active}" ng-repeat="page in pages" ng-switch="page.type"><a ng-switch-when="prev" ng-click="params.page(page.number)" href=""><span class="fa fa-backward"><span class="sr-only">Previous</span></span></a></li>
        <li ng-class="{'active': !page.active}" ng-repeat="page in pages" ng-switch="page.type">
          <a ng-switch-when="first" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a>
          <a ng-switch-when="page" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a>
          <a ng-switch-when="more" ng-click="params.page(page.number)" href="">&#8230;</a>
          <a ng-switch-when="last" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a>
        </li>
        <li ng-class="{'disabled': !page.active}" ng-repeat="page in pages" ng-switch="page.type">	<a ng-switch-when="next" ng-click="params.page(page.number)" href=""><span class="fa fa-forward"><span class="sr-only">Next</span></span></a> </li>
        <li ng-class="{'disabled': !page.active}" ng-repeat="page in pages" ng-switch="page.type"><a ng-switch-when="last" ng-click="params.page(page.number)" href=""><span class="fa fa-fast-forward"><span class="sr-only">Last</span></span></a></li>
      </ul>
    </div>
  </div>
</script>
