<!--
  ~  Submiss, eProcurement system for managing tenders
  ~  Copyright (C) 2019 Stadt Bern
  ~  Licensed under the EUPL, Version 1.2 or - as soon as they will be approved by the European Commission - subsequent versions of the EUPL (the "Licence");
  ~  You may not use this work except in compliance with the Licence.
  ~  You may obtain a copy of the Licence at:
  ~  https://joinup.ec.europa.eu/collection/eupl
  ~  Unless required by applicable law or agreed to in writing, software distributed under the Licence is
  ~  distributed on an "AS IS" basis, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
  ~  express or implied. See the Licence for the specific language governing permissions and limitations
  ~  under the Licence.
  -->

<div role="tabpanel" class="tab-pane card-box">
  <div role="tabpanel" class="tab-pane">
    <div ng-include src="'app/document/nachtrag/nachtragErrorForm.html'"></div>
    <div class="row">
      <div class="col-sm-12">
        <div id="accordionTable" class="table-responsive tableBtnAction subunternehmerTable">
          <table class="table table-condensed" style="border-collapse: collapse;">
            <thead>
              <tr>
                <th colspan="2">Zuschlagsempfänger </th>
                <th>Brutto</th>
                <th>Rabatt</th>
                <th>BNK</th>
                <th>Netto</th>
                <th>Aktion</th>
              </tr>
            </thead>
            <tbody id="offer" ng-repeat="nachtragSubmittent in nachtragCtrl.nachtragSubmittents" accordion-group
              is-open="nachtragCtrl.openSubmittentAccordion">
              <tr accordion-heading ng-class="{'grayRow': !nachtragSubmittent.isNachtragSubmittent}"
                  id="{{nachtragSubmittent.id}}">
                <td ng-click="nachtragCtrl.openSubmittentDetails(nachtragSubmittent)">
                  <span class="fa fa-caret-right" aria-hidden="true" ng-if="!nachtragSubmittent.show"></span>
                  <span class="fa fa-caret-down" aria-hidden="true" ng-if="nachtragSubmittent.show"></span>
                </td>
                <td ng-click="nachtragCtrl.openSubmittentDetails(nachtragSubmittent)">
                  {{nachtragSubmittent.submittent.submittentNameArgeSub}}</td>
                <td ng-click="nachtragCtrl.openSubmittentDetails(nachtragSubmittent)">
                  {{nachtragCtrl.formatAmount(nachtragSubmittent.grossAmount)}}
                </td>
                <td ng-if="nachtragSubmittent.isDiscountPercentage"
                  ng-click="nachtragCtrl.openSubmittentDetails(nachtragSubmittent)">
                  {{nachtragCtrl.formatAmount(nachtragSubmittent.discount)}}%
                </td>
                <td ng-if="!nachtragSubmittent.isDiscountPercentage"
                  ng-click="nachtragCtrl.openSubmittentDetails(nachtragSubmittent)">
                  {{nachtragCtrl.formatAmount(nachtragSubmittent.discount)}}
                </td>
                <td ng-if="nachtragSubmittent.isBuildingCostsPercentage">
                  {{nachtragCtrl.formatAmount(nachtragSubmittent.buildingCosts)}}%
                </td>
                <td ng-if="!nachtragSubmittent.isBuildingCostsPercentage">
                  {{nachtragCtrl.formatAmount(nachtragSubmittent.buildingCosts)}}
                </td>
                <td ng-click="nachtragCtrl.openSubmittentDetails(nachtragSubmittent)">
                  {{nachtragCtrl.customRoundNumber(nachtragSubmittent.amount)}}</td>
                <td>
                  <button type="button" class="btn action btn-primary" title="Nachtrag hinzufügen"
                    ng-click="nachtragCtrl.createNachtrag(nachtragSubmittent.id)"
                    ng-disabled="nachtragCtrl.disableCreateButton(nachtragSubmittent)">
                    <span class="fa fa-plus" aria-hidden="true"></span>
                  </button>
                </td>
              </tr>
              <tr>
                <td colspan="9" ng-if="nachtragSubmittent.show">
                  <div ng-include src="'app/document/nachtrag/nachtragList.html'"></div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
